<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Shop ƒêi·ªán tho·∫°i 2025</title>
  <style>
    @import url("https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap");

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    html, body {
      height: 100%;
    }

    :root {
      --bg: #f5f7fb;
      --card: #ffffff;
      --text: #111827;
      --muted: #6b7280;
      --accent: #0077ff;
      --shadow: rgba(2, 6, 23, 0.08);
      --btn-bg: #111827;
      --btn-text: #ffffff;
    }
    body.dark {
      --bg: #0b0f14;
      --card: #0f1720;
      --text: #e6eef8;
      --muted: #9aa8bf;
      --accent: #60a5fa;
      --shadow: rgba(2, 6, 23, 0.6);
      --btn-bg: #e6eef8;
      --btn-text: #0b0f14;
    }

    body {
      font-family: "Poppins", sans-serif;
      background: var(--bg);
      color: var(--text);
      transition: background 0.35s, color 0.35s;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    header {
      position: fixed;
      top: 0; left: 0; right: 0;
      backdrop-filter: blur(6px);
      background: rgba(255, 255, 255, 0.7);
      border-bottom: 1px solid rgba(0, 0, 0, 0.05);
      z-index: 1200;
      transition: background 0.35s, border-color 0.35s;
    }
    body.dark header {
      background: rgba(8, 12, 16, 0.6);
      border-bottom-color: rgba(255, 255, 255, 0.03);
    }
    .nav-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 14px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
    }
    .logo {
      font-weight: 600;
      color: var(--accent);
      letter-spacing: 1px;
      font-size: 20px;
    }
    nav ul {
      list-style: none;
      display: flex;
      gap: 20px;
      align-items: center;
    }
    nav a {
      text-decoration: none;
      color: var(--text);
      font-weight: 500;
      transition: color 0.3s;
    }
    nav a:hover {
      color: var(--accent);
    }
    .nav-right {
      display: flex;
      align-items: center;
      gap: 14px;
    }
    .icon-btn {
      background: var(--card);
      border-radius: 10px;
      padding: 8px 10px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      box-shadow: 0 6px 18px var(--shadow);
      cursor: pointer;
      border: none;
      transition: transform 0.2s;
    }
    .icon-btn:hover {
      transform: translateY(-2px);
    }
    .cart-badge {
      position: relative;
    }
    .badge {
      position: absolute;
      top: -6px; right: -6px;
      background: #ff3b30;
      color: #fff;
      font-size: 12px;
      padding: 2px 6px;
      border-radius: 999px;
      min-width: 18px;
      text-align: center;
    }

    #wrapper {
      max-width: 1200px;
      margin: 120px auto 80px;
      padding: 0 20px;
    }
    .headline {
      text-align: center;
      margin-bottom: 30px;
    }
    .headline h1 {
      font-size: 28px;
      font-weight: 600;
      position: relative;
      display: inline-block;
    }
    .headline h1::after {
      content: "";
      height: 3px;
      width: 80px;
      background: var(--accent);
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      bottom: -10px;
      border-radius: 4px;
    }

    .product-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 24px;
    }

    .product-card {
      background: var(--card);
      border-radius: 14px;
      overflow: hidden;
      box-shadow: 0 10px 30px var(--shadow);
      transition: transform 0.35s ease, box-shadow 0.35s ease;
      transform: translateY(24px);
      opacity: 0;
    }
    .product-card.visible {
      transform: none;
      opacity: 1;
    }
    .product-card:hover {
      transform: translateY(-6px);
      box-shadow: 0 18px 40px var(--shadow);
    }

    .product-media {
      position: relative;
      overflow: hidden;
    }
    .product-media img {
      width: 85%;
      height: 240px;
      object-fit: cover;
      transition: transform 0.45s ease;
      display: block;
    }
    .product-card:hover .product-media img {
      transform: scale(1.07);
    }

    .product-info {
      padding: 14px;
      text-align: center;
    }
    .product-cat {
      font-size: 12px;
      text-transform: uppercase;
      color: var(--muted);
      margin-bottom: 6px;
    }
    .product-title {
      font-weight: 600;
      margin-bottom: 8px;
    }
    .product-price {
      font-weight: 700;
      color: var(--text);
      margin-bottom: 12px;
    }

    .product-actions {
      display: flex;
      gap: 10px;
      justify-content: center;
      padding: 12px 14px 18px;
    }
    .btn {
      border: none;
      cursor: pointer;
      padding: 9px 14px;
      border-radius: 10px;
      font-weight: 600;
      box-shadow: 0 8px 18px rgba(2, 6, 23, 0.06);
      transition: transform 0.2s, opacity 0.2s;
    }
    .btn.add {
      background: var(--accent);
      color: #fff;
    }
    .btn.cart {
      background: transparent;
      color: var(--text);
      border: 1px solid rgba(0, 0, 0, 0.06);
    }
    body.dark .btn.cart {
      border-color: rgba(255, 255, 255, 0.06);
    }

    .cart-sidebar {
      position: fixed;
      top: 0;
      right: -440px;
      width: 380px;
      height: 100vh;
      background: var(--card);
      box-shadow: -20px 0 40px rgba(2, 6, 23, 0.12);
      transition: right 0.35s ease;
      z-index: 1300;
      display: flex;
      flex-direction: column;
    }
    .cart-sidebar.open {
      right: 0;
    }
    .cart-header {
      padding: 18px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid rgba(0, 0, 0, 0.06);
    }
    body.dark .cart-header {
      border-bottom-color: rgba(255, 255, 255, 0.03);
    }
    .cart-body {
      padding: 12px;
      overflow-y: auto;
      flex: 1;
    }
    .cart-empty {
      text-align: center;
      color: var(--muted);
      padding: 30px 10px;
    }

    .cart-item {
      display: flex;
      gap: 12px;
      padding: 12px;
      align-items: center;
      border-radius: 10px;
      margin-bottom: 10px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), transparent);
    }
    .cart-item img {
      width: 72px;
      height: 72px;
      object-fit: cover;
      border-radius: 8px;
    }
    .cart-item .meta {
      flex: 1;
    }
    .cart-item .meta .name {
      font-weight: 600;
      font-size: 14px;
      margin-bottom: 6px;
    }
    .cart-item .meta .price {
      color: var(--muted);
      font-weight: 600;
    }
    .qty-controls {
      display: flex;
      align-items: center;
      gap: 6px;
      margin-top: 8px;
    }
    .qty-controls button {
      width: 30px;
      height: 30px;
      border-radius: 8px;
      border: none;
      background: var(--btn-bg);
      color: var(--btn-text);
      cursor: pointer;
      font-weight: 700;
    }
    .qty-controls .qty {
      min-width: 32px;
      text-align: center;
      font-weight: 600;
    }

    .cart-footer {
      padding: 16px;
      border-top: 1px solid rgba(0, 0, 0, 0.06);
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    body.dark .cart-footer {
      border-top-color: rgba(255, 255, 255, 0.03);
    }
    .total-row {
      display: flex;
      justify-content: space-between;
      font-weight: 700;
      font-size: 16px;
    }
    .checkout-btn {
      background: var(--accent);
      color: #fff;
      border: none;
      padding: 12px;
      border-radius: 10px;
      font-weight: 700;
      cursor: pointer;
    }

    .overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.35);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s;
      z-index: 1250;
    }
    .overlay.show {
      opacity: 1;
      pointer-events: auto;
    }

    @media (max-width: 600px) {
      .cart-sidebar {
        width: 100%;
        right: -100%;
      }
      .cart-sidebar.open {
        right: 0;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="nav-container">
      <div class="logo">Smartphone Shop</div>
      <nav>
        <ul>
          <li><a href="index.html">Trang ch·ªß</a></li>
          <li><a href="sanpham.html">S·∫£n ph·∫©m</a></li>
          <li><a href="lienhe.html">Li√™n h·ªá</a></li>
           <li><a href="gioithieu.html">Gi·ªõi Thi·ªáu</a></li>
        </ul>
      </nav>
      <div class="nav-right">
        <button id="toggleTheme" title="Chuy·ªÉn giao di·ªán">üåô</button>
        <button class="icon-btn cart-badge" id="cartBtn" title="Gi·ªè h√†ng">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" style="display:block">
            <path d="M3 3h2l.4 2M7 13h10l4-8H5.4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
            <circle cx="10" cy="19" r="1" fill="currentColor"></circle>
            <circle cx="18" cy "19" r="1" fill="currentColor"></circle>
          </svg>
          <div class="badge" id="cartCount" style="display:none">0</div>
        </button>
      </div>
    </div>
  </header>

  <main id="wrapper">
    <div class="headline">
      <h1>ƒêi·ªán tho·∫°i n·ªïi b·∫≠t 2025</h1>
    </div>
    <section class="product-grid" id="productGrid">
      <!-- S·∫£n ph·∫©m s·∫Ω ƒë∆∞·ª£c t·∫°o b·∫±ng JS -->
    </section>
  </main>

  <div class="cart-sidebar" id="cartSidebar" aria-hidden="true">
    <div class="cart-header">
      <div style="font-weight:700">Gi·ªè h√†ng</div>
      <div style="display:flex; gap:8px;">
        <button id="clearCart" class="icon-btn" title="X√≥a t·∫•t c·∫£">X√≥a t·∫•t c·∫£</button>
        <button id="closeCart" class="icon-btn" title="ƒê√≥ng">‚úï</button>
      </div>
    </div>
    <div class="cart-body" id="cartBody">
      <div class="cart-empty" id="cartEmpty">Gi·ªè h√†ng tr·ªëng ‚Äî th√™m s·∫£n ph·∫©m ngay!</div>
    </div>
    <div class="cart-footer">
      <div class="total-row"><div>T·∫°m t√≠nh</div><div id="cartTotal">0‚Ç´</div></div>
      <button class="checkout-btn" id="checkoutBtn">Thanh to√°n</button>
    </div>
  </div>

  <div class="overlay" id="overlay"></div>

  <script>
    // Danh s√°ch s·∫£n ph·∫©m m·∫´u (2025): id, t√™n, gi√°, ·∫£nh
    const products = [
      { id: 'iphone16pro', title: 'iPhone 16 Pro', price: 27990000, img: '/Iphone 16 Pro.webp' },
      { id: 'galaxyz25', title: 'Samsung Galaxy Z25', price: 30990000, img: '/samsunggalaxys23.webp' },
      { id: 'pixel_10', title: 'Google Pixel 10', price: 23990000, img: '/Google Pixel 10.webp' },
      { id: 'xiaomi_15t', title: 'Xiaomi 15T Pro', price: 18990000, img: '/Xiaomi 15T Pro.webp' },
      { id: 'oppo_findx8', title: 'Oppo Find X8', price: 19990000, img: '/Oppo Find X8.webp' },
      { id: 'oneplus_14', title: 'OnePlus 14', price: 21990000, img: '/OnePlus 14.webp' },
      { id: 'vivo_x100', title: 'Vivo X100', price: 16990000, img: '/Vivo X100.webp' },
      { id: 'asus_rog8', title: 'ASUS ROG Phone 8', price: 29990000, img: '/ASUS ROG Phone 8.webp' }
    ];

    const productGrid = document.getElementById('productGrid');

    function formatVND(num) {
      return new Intl.NumberFormat('vi-VN').format(num) + '‚Ç´';
    }

    // T·∫°o card s·∫£n ph·∫©m
    products.forEach(p => {
      const card = document.createElement('div');
      card.className = 'product-card item';
      card.innerHTML = `
        <div class="product-media">
          <img src="${p.img}" alt="${p.title}" loading="lazy" />
        </div>
        <div class="product-info">
          <div class="product-cat">Smartphone</div>
          <div class="product-title">${p.title}</div>
          <div class="product-price">${formatVND(p.price)}</div>
        </div>
        <div class="product-actions">
          <button class="btn add" data-id="${p.id}">Th√™m gi·ªè</button>
          <button class="btn cart" data-id="${p.id}">Mua ngay</button>
        </div>
      `;
      productGrid.appendChild(card);
    });

    // Animation khi cu·ªôn
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(ent => {
        if (ent.isIntersecting) {
          ent.target.classList.add('visible');
          observer.unobserve(ent.target);
        }
      });
    }, { threshold: 0.12 });
    document.querySelectorAll('.item').forEach(e => observer.observe(e));

    // Gi·ªè h√†ng: l∆∞u ·ªü localStorage
    const CART_KEY = 'shop_cart_2025';
    function getCart() {
      return JSON.parse(localStorage.getItem(CART_KEY) || '{}');
    }
    function saveCart(cart) {
      localStorage.setItem(CART_KEY, JSON.stringify(cart));
    }
    function cartTotals() {
      const cart = getCart();
      let count = 0, total = 0;
      Object.values(cart).forEach(it => {
        count += it.qty;
        total += it.qty * it.price;
      });
      return { count, total };
    }

    // Th√™m hi·ªáu ·ª©ng bay ·∫£nh v√†o icon gi·ªè
    function flyToCart(imgElem) {
      const cartBtn = document.getElementById('cartBtn');
      const badge = document.getElementById('cartCount');

      const imgRect = imgElem.getBoundingClientRect();
      const btnRect = cartBtn.getBoundingClientRect();

      // clone ·∫£nh
      const clone = imgElem.cloneNode(true);
      clone.style.position = 'fixed';
      clone.style.left = imgRect.left + 'px';
      clone.style.top = imgRect.top + 'px';
      clone.style.width = imgRect.width + 'px';
      clone.style.height = imgRect.height + 'px';
      clone.style.transition = 'all 0.8s cubic-bezier(.65,.05,.36,1)';
      clone.style.zIndex = 2000;
      document.body.appendChild(clone);

      // to position of cart icon (center)
      const targetX = btnRect.left + btnRect.width/2 - imgRect.width/2;
      const targetY = btnRect.top + btnRect.height/2 - imgRect.height/2;

      setTimeout(() => {
        clone.style.left = targetX + 'px';
        clone.style.top = targetY + 'px';
        clone.style.width = '20px';
        clone.style.height = '20px';
        clone.style.opacity = '0.5';
      }, 10);

      clone.addEventListener('transitionend', () => {
        clone.remove();
      });
    }

    function addToCart(productId, qty = 1, imgElem) {
      const cart = getCart();
      if (cart[productId]) cart[productId].qty += qty;
      else {
        const prod = products.find(p => p.id === productId);
        cart[productId] = {
          id: productId,
          title: prod.title,
          price: prod.price,
          img: prod.img,
          qty: qty
        };
      }
      saveCart(cart);
      renderCart();
      animateCartBadge();
      showCartSidebar();

      if (imgElem) {
        flyToCart(imgElem);
      }
    }

    function removeFromCart(productId) {
      const cart = getCart();
      if (cart[productId]) delete cart[productId];
      saveCart(cart);
      renderCart();
      animateCartBadge();
    }

    function updateQty(productId, qty) {
      const cart = getCart();
      if (!cart[productId]) return;
      cart[productId].qty = qty;
      if (cart[productId].qty <= 0) delete cart[productId];
      saveCart(cart);
      renderCart();
      animateCartBadge();
    }

    function clearCart() {
      localStorage.removeItem(CART_KEY);
      renderCart();
      animateCartBadge();
    }

    // Render gi·ªè h√†ng
    const cartBody = document.getElementById('cartBody');
    const cartEmpty = document.getElementById('cartEmpty');
    const cartTotalEl = document.getElementById('cartTotal');
    const cartCountEl = document.getElementById('cartCount');

    function renderCart() {
      const cart = getCart();
      cartBody.querySelectorAll('.cart-item').forEach(n => n.remove());
      const items = Object.values(cart);
      if (items.length === 0) {
        cartEmpty.style.display = 'block';
      } else {
        cartEmpty.style.display = 'none';
        items.forEach(it => {
          const node = document.createElement('div');
          node.className = 'cart-item';
          node.innerHTML = `
            <img src="${it.img}" alt="${it.title}">
            <div class="meta">
              <div class="name">${it.title}</div>
              <div class="price">${formatVND(it.price)}</div>
              <div class="qty-controls">
                <button class="qty-dec" data-id="${it.id}">‚àí</button>
                <div class="qty">${it.qty}</div>
                <button class="qty-inc" data-id="${it.id}">+</button>
                <button class="btn" style="background:transparent;color:var(--muted);margin-left:8px;" data-action="remove" data-id="${it.id}">X√≥a</button>
              </div>
            </div>
          `;
          cartBody.insertBefore(node, cartBody.firstChild);
        });
      }
      const totals = cartTotals();
      cartTotalEl.textContent = formatVND(totals.total);
      if (totals.count > 0) {
        cartCountEl.style.display = 'block';
        cartCountEl.textContent = totals.count;
      } else {
        cartCountEl.style.display = 'none';
      }
    }

    document.addEventListener('click', e => {
      const addBtn = e.target.closest('.btn.add');
      if (addBtn) {
        const id = addBtn.dataset.id;
        // t√¨m ·∫£nh t∆∞∆°ng ·ª©ng trong c√πng th·∫ª card
        const imgEl = addBtn.closest('.product-card').querySelector('img');
        addToCart(id, 1, imgEl);
      }
      const buyBtn = e.target.closest('.btn.cart');
      if (buyBtn) {
        const id = buyBtn.dataset.id;
        const imgEl = buyBtn.closest('.product-card').querySelector('img');
        addToCart(id, 1, imgEl);
      }
      const dec = e.target.closest('.qty-dec');
      if (dec) {
        const id = dec.dataset.id;
        const cart = getCart();
        const current = cart[id] ? cart[id].qty : 0;
        updateQty(id, current - 1);
      }
      const inc = e.target.closest('.qty-inc');
      if (inc) {
        const id = inc.dataset.id;
        const cart = getCart();
        const current = cart[id] ? cart[id].qty : 0;
        updateQty(id, current + 1);
      }
      const rem = e.target.closest('[data-action="remove"]');
      if (rem) {
        const id = rem.dataset.id;
        removeFromCart(id);
      }
    });

    // Sidebar logic
    const cartBtn = document.getElementById('cartBtn');
    const cartSidebar = document.getElementById('cartSidebar');
    const overlay = document.getElementById('overlay');
    const closeCart = document.getElementById('closeCart');
    const clearCartBtn = document.getElementById('clearCart');
    const checkoutBtn = document.getElementById('checkoutBtn');

    function showCartSidebar() {
      cartSidebar.classList.add('open');
      overlay.classList.add('show');
      cartSidebar.setAttribute('aria-hidden', 'false');
    }
    function hideCartSidebar() {
      cartSidebar.classList.remove('open');
      overlay.classList.remove('show');
      cartSidebar.setAttribute('aria-hidden', 'true');
    }

    cartBtn.addEventListener('click', () => {
      renderCart();
      showCartSidebar();
    });
    closeCart.addEventListener('click', hideCartSidebar);
    overlay.addEventListener('click', hideCartSidebar);
    clearCartBtn.addEventListener('click', () => {
      if (confirm('B·∫°n mu·ªën x√≥a to√†n b·ªô gi·ªè h√†ng?')) clearCart();
    });
    checkoutBtn.addEventListener('click', () => {
      const totals = cartTotals();
      if (totals.count === 0) {
        alert('Gi·ªè h√†ng ƒëang tr·ªëng!');
        return;
      }
      const ok = confirm(`Thanh to√°n ${formatVND(totals.total)} cho ${totals.count} s·∫£n ph·∫©m?`);
      if (ok) {
        alert('Thanh to√°n th√†nh c√¥ng (demo). Gi·ªè h√†ng ƒë√£ ƒë∆∞·ª£c l√†m m·ªõi.');
        clearCart();
        hideCartSidebar();
      }
    });

    function animateCartBadge() {
      cartCountEl.animate([
        { transform: 'scale(1)' },
        { transform: 'scale(1.4)' },
        { transform: 'scale(1)' }
      ], { duration: 280, easing: 'ease' });
    }

    // Dark mode toggle
    const toggleThemeBtn = document.getElementById('toggleTheme');
    function applySavedTheme() {
      const saved = localStorage.getItem('shop_theme_2025');
      if (saved === 'dark') document.body.classList.add('dark');
      toggleThemeBtn.textContent = document.body.classList.contains('dark') ? '‚òÄÔ∏è' : 'üåô';
    }
    applySavedTheme();
    toggleThemeBtn.addEventListener('click', () => {
      document.body.classList.toggle('dark');
      localStorage.setItem('shop_theme_2025', document.body.classList.contains('dark') ? 'dark' : 'light');
      toggleThemeBtn.textContent = document.body.classList.contains('dark') ? '‚òÄÔ∏è' : 'üåô';
    });

    // On load
    window.addEventListener('load', () => {
      renderCart();
      document.querySelectorAll('.item').forEach(i => observer.observe(i));
    });
    document.addEventListener('keydown', e => {
      if (e.key === 'Escape') hideCartSidebar();
    });
  </script>
</body>
</html>
